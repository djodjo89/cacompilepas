{"ast":null,"code":"/**\n * Generic method to test regex\n *\n * @private\n * @param {string} regex - regex to test\n *                           with password\n */\nvar regex = require('./constants').regex;\n\nfunction _process(regexp) {\n  return new RegExp(regexp).test(this.password) === this.positive;\n}\n\nmodule.exports = {\n  /**\n   * Method to invert the next validations\n   *\n   * @param {RegExp} [symbol] - custom Regex which should not be present\n   */\n  not: function not(symbol) {\n    this.positive = false;\n\n    if (symbol) {\n      return _process.call(this, symbol);\n    }\n\n    return true;\n  },\n\n  /**\n   * Method to invert the effects of not()\n   *\n   * @param {RegExp} [symbol] - custom Regex which should be present\n   */\n  has: function has(symbol) {\n    this.positive = true;\n\n    if (symbol) {\n      return _process.call(this, symbol);\n    }\n\n    return true;\n  },\n\n  /**\n   * Method to invert the effects of not() and\n   * to make the api readable and chainable\n   *\n   */\n  is: function is() {\n    this.positive = true;\n    return true;\n  },\n\n  /**\n   * Method to specify a minimum length\n   *\n   * @param {number} num - minimum length\n   */\n  min: function min(num) {\n    return this.password.length >= num;\n  },\n\n  /**\n   * Method to specify a maximum length\n   *\n   * @param {number} num - maximum length\n   */\n  max: function max(num) {\n    return this.password.length <= num;\n  },\n\n  /**\n   * Method to validate the presence of digits\n   */\n  digits: function digits() {\n    return _process.call(this, regex.digits);\n  },\n\n  /**\n   * Method to validate the presence of letters\n   */\n  letters: function letters() {\n    return _process.call(this, regex.letters);\n  },\n\n  /**\n   * Method to validate the presence of uppercase letters\n   */\n  uppercase: function uppercase() {\n    return this.password !== this.password.toLowerCase() === this.positive;\n  },\n\n  /**\n   * Method to validate the presence of lowercase letters\n   */\n  lowercase: function lowercase() {\n    return this.password !== this.password.toUpperCase() === this.positive;\n  },\n\n  /**\n   * Method to validate the presence of symbols\n   */\n  symbols: function symbols() {\n    return _process.call(this, regex.symbols);\n  },\n\n  /**\n   * Method to validate the presence of space\n   */\n  spaces: function spaces() {\n    return _process.call(this, regex.spaces);\n  },\n\n  /**\n   * Method to provide pre-defined values for password\n   *\n   * @param {array} list - list of values allowed\n   */\n  oneOf: function oneOf(list) {\n    return list.indexOf(this.password) >= 0 === this.positive;\n  }\n};","map":null,"metadata":{},"sourceType":"script"}